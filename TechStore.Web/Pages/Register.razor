@page "/registrar"

@using TechStore.Application.DTOs
@using TechStore.Web.Services

@inject AuthService Auth
@inject NavigationManager Navigation

<PageTitle>Criar Conta</PageTitle>

<div class="container d-flex justify-content-center align-items-center mt-5">
    <div class="card shadow-sm p-4 register-card" style="max-width: 450px; width: 100%;">
        <h3 class="text-center fw-bold mb-4">Criar Conta</h3>

        <EditForm Model="@model" OnValidSubmit="Registrar">
            <DataAnnotationsValidator />
            <ValidationSummary class="text-danger mb-3" />

            <div class="mb-3">
                <label class="form-label">Nome Completo</label>
                <InputText class="form-control" @bind-Value="model.NomeCompleto" />
            </div>

            <div class="mb-3">
                <label class="form-label">Email</label>
                <InputText class="form-control" @bind-Value="model.Email" />
            </div>

            <div class="mb-3">
                <label class="form-label">CPF</label>
                <InputText class="form-control" @bind-Value="model.CPF" />
            </div>

            <div class="mb-3">
                <label class="form-label">Data de Nascimento</label>
                <InputDate class="form-control" @bind-Value="model.DataNascimento" />
            </div>

            <div class="mb-3">
                <label class="form-label">Senha</label>
                <InputText type="password" class="form-control" @bind-Value="model.Senha" />
            </div>

            <div class="mb-4">
                <label class="form-label">Confirmar Senha</label>
                <InputText type="password" class="form-control" @bind-Value="model.ConfirmarSenha" />
            </div>

            <button type="submit" class="btn btn-dark w-100">
                Criar Conta
            </button>
        </EditForm>
    </div>
</div>

@code {
    private RegistrarUsuarioDTO model = new();

    private async Task Registrar()
    {
        var sucesso = await Auth.RegistrarAsync(model);

        if (sucesso)
        {
            Navigation.NavigateTo("/login");
        }
    }
}
